### Конформист

Отношения Заказчик–Поставщик жизнеспособны тогда, когда обе команды реально заинтересованы их поддерживать. При этом зависимость несимметрична: заказчик сильно зависит от поставщика, а поставщик от заказчика почти нет. Если руководство специально выстроило эту схему и удерживает её в рабочем состоянии, поставщик будет уделять заказчику нужное внимание и учитывать его запросы. Но если правила взаимодействия между командами не определены ясно, или управление слабое, либо отсутствует, поставщик постепенно смещает фокус на свою доменную модель и архитектуру и всё меньше заинтересован помогать заказчику. У них, в конце концов, свои сроки. Даже если люди в команде поставщика хорошие и готовы помогать, давление дедлайнов всё равно возьмёт верх и пострадает команда заказчика. Та же картина часто возникает, когда команды принадлежат разным компаниям. Коммуникация сложнее, а компания поставщика может не хотеть много вкладываться в эти отношения. Тогда помощь будет редкой и эпизодической, либо поставщик вообще откажется сотрудничать. В результате команда заказчика остаётся одна и пытается сделать максимум возможного со своей моделью и архитектурными решениями, опираясь на то, что ей фактически дают.

Когда две команды находятся в отношениях Заказчик–Поставщик, но у команды поставщика нет мотивации учитывать потребности заказчика, у команды заказчика фактически нет рычагов влияния. Разработчики поставщика могут из лучших побуждений пообещать помочь, но такие обещания обычно не выполняются. Доверие к этим намерениям заставляет заказчика строить планы, опираясь на функциональность, которой так и не появится. В итоге проект заказчика начинает сдвигаться по срокам, пока команда не приспособится жить с тем, что ей реально дают. На интерфейс, специально подстроенный под нужды заказчика, в такой ситуации рассчитывать не приходится.

У команды заказчика выбор невелик. Самый очевидный вариант это отделиться от поставщика и дальше жить полностью самостоятельно. Позже мы рассмотрим это в паттерне Separate Ways.Иногда выгоды, которые даёт подсистема поставщика, не окупают связанных с ней хлопот и издержек. В таких случаях проще завести собственную модель предметной области и проектировать, не оглядываясь на модель поставщика. Но так бывает не всегда.

Иногда в модели поставщика есть некоторая ценность, и связь с ней приходится поддерживать. Но раз команда поставщика не помогает команде заказчика, заказчику нужно защитить свой контекст от изменений, которые поставщик вносит в свою модель. Для этого придётся сделать слой трансляции, который связывает два Ограниченных контекста через явный “перевод”. Возможен и другой сценарий: модель поставщика изначально плохо продумана, поэтому пользоваться ею неудобно. Контекст заказчика всё равно может её использовать, но должен изолировать свою доменную модель через Антикоррупционный слой (Anticorruption Layer), о котором будет сказано дальше.

Если команде заказчика всё равно приходится использовать модель команды поставщика, и эта модель сделана качественно, может подойти стратегия Конформист (Conformist). В этом случае команда заказчика принимает модель поставщика как “истину” и целиком подстраивает под неё свой контекст. Это похоже на Общее ядро (Shared Kernel), но отличие принципиальное, заказчик не может менять “ядро” этой общей модели. Он может только использовать его как часть своей модели и строить поверх уже предоставленного кода. Во многих ситуациях такое решение вполне жизнеспособно. Если вам дают богатый компонент и понятный интерфейс к нему, можно включить этот компонент в свою модель так, как будто он ваш. Если же у компонента небольшой интерфейс, часто выгоднее сделать к нему адаптер и переводить между вашей моделью и моделью компонента. Тогда ваша доменная модель остаётся изолированной, и вы можете развивать её с большой степенью свободы.