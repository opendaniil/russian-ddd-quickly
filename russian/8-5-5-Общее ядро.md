### Общее ядро

![](../img/Image21.png)

Когда глубина функциональной интеграции ограничена, накладные расходы Непрерывной интеграции (CI) могут счесть слишком высокими. Особенно если у команд не хватает компетенций или организационной договороспособности, чтобы CI реально поддерживать, либо одна команда просто слишком большая и неповоротливая. Тогда имеет смысл выделить отдельные Ограниченные контексты и сформировать несколько команд.

Команды, работающие без координации над сильно взаимосвязанными приложениями, какое то время могут быстро двигаться вперёд, но результаты могут не сложиться в единое целое. В итоге они тратят больше на слои трансляции и переделки задним числом, чем потратили бы на Непрерывную интеграцию (CI) изначально, одновременно дублируя усилия и теряя выгоды общего Единого языка.

Therefore, designate some subset of the domain model that the two teams agree to share. Of course this includes, along with this subset of the model, the subset of code or of the database design associated with that part of the model. This explicitly shared stuff has special status, and shouldn’t be changed without consultation with the other team. 

Поэтому закрепите общую часть доменной модели, которую обе команды договорились разделять. Разумеется, вместе с этой частью модели разделяются и связанные с ней части кода и схемы БД. Всё это явно общее имеет особый статус, и менять это можно только после консультации с другой командой.

Регулярно сводите изменения в единый рабочий вариант системы, но делайте это чуть реже, чем вы делаете CI внутри каждой команды. При каждом таком сведении запускайте тесты обеих команд, чтобы проверить совместимость.

Смысл Общего ядра (Shared Kernel) в том, чтобы уменьшить дублирование, но при этом не смешивать два Ограниченных контекста в один. Поэтому к разработке Общего ядра нужно относиться как к зоне повышенного риска: обе команды могут в него вносить изменения, а значит им придётся регулярно сводить эти изменения между собой. Если у команд отдельные копии кода Общего ядра, сливать их нужно как можно быстрее, минимум раз в неделю, иначе расхождения и конфликты начнут накапливаться. Обязательно должен быть общий набор автотестов, чтобы каждое изменение ядра проверялось сразу. И любые изменения в ядре нужно явно доносить до другой команды, чтобы обе стороны понимали, что именно поменялось и какая новая функциональность появилась.